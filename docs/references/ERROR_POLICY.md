# GILIME — Error Handling Policy

**목적:** 에러 처리 규칙 정의. 본 버전에서는 **정책만** 기술하며, 코드 변경은 하지 않음.

---

## SQL failure

- **사용자에게 보여줄 것:** 운영자 페이지에서는 **경고성 문구**(muted 텍스트 또는 "일시적 오류" 안내). 쿼리 내용·스택 트레이스는 노출하지 않음.
- **로그에 남길 것:** 에러 메시지, 실패한 쿼리(바인드 값 제외 또는 파라미터 마스킹), 요청 컨텍스트(script name, doc_id/route_label 등 식별자). 스택 트레이스는 로그 전용.
- **동작:** 해당 요청은 중단. 리다이렉트 또는 빈 목록/빈 폼 등 안전한 상태로 복귀.

---

## Missing or invalid parameters

- **대상:** doc_id, route_label, source_doc_id, cand_id, job_id 등 필수/선택 파라미터.
- **사용자에게 보여줄 것:** **muted 텍스트** ("항목을 찾을 수 없습니다" / "잘못된 요청입니다"). 400 스타일 안내. 상세 파라미터 이름은 노출하지 않음.
- **로그에 남길 것:** 누락/잘못된 파라미터 이름, 받은 값(민감하지 않은 경우), 요청 URI.
- **동작:** 해당 동작은 수행하지 않음. 목록 페이지 또는 상위 문서 페이지로 돌리거나, 현재 페이지에서 오류 문구만 표시.

---

## Forbidden access (admin-only)

- **상황:** 비로그인 또는 권한 없는 사용자가 /admin/* (login/logout 제외) 접근.
- **사용자에게 보여줄 것:** **리다이렉트** to /admin/login.php. 별도 "접근 거부" 메시지는 선택.
- **로그에 남길 것:** 접근 시도 URI, IP(정책에 따라), 미인증/권한 없음 여부.
- **동작:** 302 to login. 403 본문은 사용하지 않거나, 로그인 후에도 권한 없을 때만 검토.

---

## Not found (invalid doc_id / resource)

- **상황:** 유효한 doc_id가 아니거나, 해당 문서/노선/후보가 존재하지 않음.
- **사용자에게 보여줄 것:** **muted 텍스트** ("문서를 찾을 수 없습니다" / "해당 항목이 없습니다"). 404 스타일. 존재 여부를 노출하지 않음.
- **로그에 남길 것:** 요청한 식별자(doc_id, route_label 등), 요청 URI.
- **동작:** 해당 페이지에서 안내만 표시하거나, 목록(index/doc)으로 링크 제공.

---

## 공통 원칙

- **사용자 화면:** 기술 세부사항(쿼리, 경로, 스택) 노출 금지. muted 문구 또는 안전한 리다이렉트.
- **로그:** 에러 메시지, 식별 가능한 컨텍스트, (정책에 따라) 쿼리·스택. 로그는 웹에서 직접 접근 불가(storage/ 등).

---

*문서 버전: v1.3-06 (docs-only). 코드 반영은 별도 버전에서 진행.*
