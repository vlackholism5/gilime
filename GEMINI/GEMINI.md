# Gemini Project Rules

- 모든 답변은 한국어로 작성한다.
- 개발 초보자도 이해할 수 있도록 설명한다.
- 코드 설명 시 흐름 → 역할 → 예시 순서로 설명한다.
- PHP / JS 혼합 프로젝트 기준으로 설명한다.

# 추가 규칙 (길라임 프로젝트 공통)

- 변경은 항상 최소 diff로 제시한다(전체 파일 교체 금지).
- 답변은: 적용 순서 → diff → 검증 체크리스트 → 롤백 순으로 작성한다.
- 불확실하면 “확인 필요”로 표기하고, 확인 방법(로그/쿼리/명령)을 함께 제시한다.

## 보안/환경
- API Key/DB 비번/토큰은 코드·커밋·로그에 절대 남기지 않는다.
- 시크릿은 .env 또는 config.local.php로만 주입한다(예시는 DUMMY 값 사용).

## DB/마이그레이션
- 스키마 변경 시 DDL + Migration 설명 + Verification SQL(검증쿼리)을 함께 제공한다.
- ingest/업서트/매칭은 재실행해도 결과가 망가지지 않게(idempotent) 설계한다.
- 모든 배치/파싱/매칭은 run_id 단위로 로그/상태를 기록한다.

## PDF 파싱/정류소 매칭
- 파싱 → 정규화 → 후보생성 → 스코어링 → 확정 단계를 분리해 유지한다.
- 매칭 결과는 결정값과 근거를 함께 저장한다(score, method, top candidates).
- 관리자 수동 확정(locked)은 자동 매칭이 덮어쓰지 않는다.

## 코드 규칙
- PHP: strict_types 유지, prepared statement만 사용, 입력검증/예외처리 기본.
- JS: API 요청/응답 스키마(에러 포함)를 먼저 고정하고 구현한다.
